(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[368],{9516:function(e,a,t){Promise.resolve().then(t.bind(t,5614))},5614:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return o}});var r=t(7437),s=t(2265);function l(e){let{filters:a,onFiltersChange:t}=e,[l,i]=(0,s.useState)([]),[n,c]=(0,s.useState)(a);(0,s.useEffect)(()=>{o()},[]);let o=async()=>{try{let e=await fetch("/api/categories");if(e.ok){let a=await e.json();i(a)}}catch(e){console.error("Error fetching categories:",e)}},d=(e,a)=>{c({...n,[e]:a})};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,r.jsx)("input",{type:"text",id:"search",value:n.search,onChange:e=>d("search",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cake-pink focus:border-transparent",placeholder:"Search cakes..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsxs)("select",{id:"category",value:n.category,onChange:e=>d("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cake-pink focus:border-transparent",children:[(0,r.jsx)("option",{value:"",children:"All Categories"}),l.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Range (\xa3)"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"number",value:n.minPrice,onChange:e=>d("minPrice",e.target.value),className:"w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cake-pink focus:border-transparent",placeholder:"Min",min:"0"}),(0,r.jsx)("input",{type:"number",value:n.maxPrice,onChange:e=>d("maxPrice",e.target.value),className:"w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cake-pink focus:border-transparent",placeholder:"Max",min:"0"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,r.jsx)("input",{type:"text",id:"location",value:n.location,onChange:e=>d("location",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cake-pink focus:border-transparent",placeholder:"City or postcode"})]}),(0,r.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,r.jsx)("button",{onClick:()=>{t(n)},className:"w-full bg-gradient-to-r from-cake-pink to-cake-purple text-white py-2 px-4 rounded-lg font-medium hover:opacity-90",children:"Apply Filters"}),(0,r.jsx)("button",{onClick:()=>{let e={search:"",category:"",minPrice:"",maxPrice:"",location:""};c(e),t(e)},className:"w-full bg-gray-200 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-300",children:"Reset Filters"})]})]})]})}var i=t(6648),n=t(7138);function c(e){let{cake:a}=e;return(0,r.jsx)(n.default,{href:"/cakes/".concat(a.id),children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",children:[(0,r.jsxs)("div",{className:"relative h-64",children:[a.images[0]?(0,r.jsx)(i.default,{src:a.images[0],alt:a.title,fill:!0,className:"object-cover"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-cake-pink to-cake-purple flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-6xl",children:"\uD83C\uDF70"})}),(0,r.jsxs)("div",{className:"absolute top-2 left-2 flex gap-2",children:[a.urgencyFlag&&(0,r.jsx)("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"Urgent"}),a.freshIndicator&&(0,r.jsx)("span",{className:"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"Fresh Today"}),"VERIFIED"===a.baker.user.verificationStatus&&(0,r.jsx)("span",{className:"bg-blue-500 text-white px-2 py-1 rounded-full text-xs font-semibold",children:"âœ“ Verified"})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-lg mb-1 line-clamp-1",children:a.title}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-2 line-clamp-2",children:a.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("span",{className:"text-2xl font-bold text-cake-purple",children:["\xa3",a.price]}),a._count.orders>0&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[a._count.orders," sold"]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,r.jsx)("p",{className:"font-medium",children:a.baker.businessName}),(0,r.jsx)("p",{children:a.baker.location})]})]})]})})}function o(){let[e,a]=(0,s.useState)([]),[t,i]=(0,s.useState)(!0),[n,o]=(0,s.useState)({search:"",category:"",minPrice:"",maxPrice:"",location:""}),[d,u]=(0,s.useState)({page:1,limit:12,total:0,totalPages:0});(0,s.useEffect)(()=>{g()},[n,d.page]);let g=async()=>{i(!0);let e=new URLSearchParams({page:d.page.toString(),limit:d.limit.toString(),...Object.entries(n).reduce((e,a)=>{let[t,r]=a;return r&&(e[t]=r),e},{})});try{let t=await fetch("/api/cakes?".concat(e));if(t.ok){let e=await t.json();a(e.cakes),u(e.pagination)}}catch(e){console.error("Error fetching cakes:",e)}finally{i(!1)}};return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Browse Cakes"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Discover delicious cakes from talented local bakers"})]}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,r.jsx)("div",{className:"lg:w-1/4",children:(0,r.jsx)(l,{filters:n,onFiltersChange:e=>{o(e),u(e=>({...e,page:1}))}})}),(0,r.jsx)("div",{className:"lg:w-3/4",children:t?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"text-gray-500",children:"Loading delicious cakes..."})}):0===e.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No cakes found"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Try adjusting your filters or search terms"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,r.jsx)(c,{cake:e},e.id))}),d.totalPages>1&&(0,r.jsx)("div",{className:"mt-8 flex justify-center",children:(0,r.jsxs)("nav",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>u(e=>({...e,page:e.page-1})),disabled:1===d.page,className:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),[...Array(d.totalPages)].map((e,a)=>(0,r.jsx)("button",{onClick:()=>u(e=>({...e,page:a+1})),className:"px-4 py-2 rounded-lg ".concat(d.page===a+1?"bg-gradient-to-r from-cake-pink to-cake-purple text-white":"border border-gray-300 hover:bg-gray-50"),children:a+1},a+1)),(0,r.jsx)("button",{onClick:()=>u(e=>({...e,page:e.page+1})),disabled:d.page===d.totalPages,className:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})})]})})]})]})}},6648:function(e,a,t){"use strict";t.d(a,{default:function(){return s.a}});var r=t(5601),s=t.n(r)},7138:function(e,a,t){"use strict";t.d(a,{default:function(){return s.a}});var r=t(231),s=t.n(r)},5601:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),function(e,a){for(var t in a)Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}(a,{default:function(){return c},getImageProps:function(){return n}});let r=t(9920),s=t(497),l=t(8173),i=r._(t(1241));function n(e){let{props:a}=(0,s.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,t]of Object.entries(a))void 0===t&&delete a[e];return{props:a}}let c=l.Image}},function(e){e.O(0,[231,173,971,23,744],function(){return e(e.s=9516)}),_N_E=e.O()}]);